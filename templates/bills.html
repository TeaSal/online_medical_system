{% extends "layout.html" %}
{% block content %}
<h4 class="fw-bold mb-3">My Bills</h4>
<div id="billsList" class="list-group"></div>

<script>
fetch("/api/bills")
  .then(res => res.json())
  .then(data => {
    if (data.error) {
      document.getElementById("billsList").innerHTML = "<p>Please log in to view your bills.</p>";
      return;
    }

    if (data.length === 0) {
      document.getElementById("billsList").innerHTML = "<p>No bills found.</p>";
      return;
    }

    document.getElementById("billsList").innerHTML = data.map(b => `
      <div class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <div><strong>Appointment #${b.appointment_id}</strong></div>
          <div class="small text-muted">Created: ${new Date(b.created_at).toLocaleDateString()}</div>
        </div>
        <div>
          <span class="me-3">â‚¹${b.amount.toFixed(2)}</span>
          <span class="badge ${b.status === 'paid' ? 'bg-success' : 'bg-warning'}">${b.status}</span>
        </div>
      </div>
    `).join("");
  });
</script>
{% endblock %}
